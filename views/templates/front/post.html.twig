{% extends "layout.html.twig" %}

{% block title %}Article {{ post.title|e }}{% endblock %}
{% block content %}
   <!-- BREADCRUMB -->
   <nav class="breadcrumbs">
      <ul>
         <li><a href="/blog_php" class="home">Accueil</a></li>
         <li><a href="/blog_php/posts">Articles</a></li>
         <li class="threadTitle">Article {{ post.title|e }}</li>
         <li class="threadTitle300" title="Article {{ post.title|e }}">Article {{ post.title|slice(0, 10) }}...</li>
      </ul>
   </nav>
   <!-- MAIN CONTENT -->
   <div class="container">
      <div class="flex-column mx-auto">
         <h2 class="text-center">{{ post.title|e }}</h2>
         <p class="mb-5 text-center">{{ post.chapo|e }}</p>
         <p>{{ post.contents|nl2br }}</p>
         <p class="mt-5 text-end fw-bold name">{{ post.user_username|e }}</p>
         <p class="text-end">{% if post.date_updated is defined %}le {{ post.date_updated|date("d/m/Y") }}{% endif %}</p>
      </div>
      <div class="comment-box">
         <div class="d-flex justify-content-center row">
            <div class="d-flex flex-column comment-section">
               {% for comment in comments %}
                  <div class="bg-white p-2">
                     <div class="d-flex flex-column justify-content-start ml-2"><span class="d-block name">{{ comment.user_username|e }}</span><span class="text-black-50">Partagé le {% if comment.date_updated is defined %}{{ comment.date_updated|date("d/m/Y à H:i")|replace({':': "h"}) }}{% endif %}</span></div>
                     <div class="mt-2 mb-5">
                        <p>{{ comment.contents|nl2br }}</p>
                     </div>
                     <!--<div class="mb-5 text-end cursor"><i class="far fa-comment-dots"></i><span class="ms-2">Répondre</span></div>-->
                  </div>
               {% endfor %}
               <form method="POST">
                  <div class="bg-light p-2">
                     <label for="contents" class="mt-3">Commentaire :</label>
                     <textarea id="contents" class="form-control shadow-none textarea" name="contents" rows="6">{% if contents is defined %}{{ contents|e }}{% endif %}</textarea>
                     {% if errors.emptyContents is defined %}
                        <p>{{ errors.emptyContents|e }}</p>
                     {% endif %}
                     <div class="form-group mt-3">
                        <label for="username">Nom :</label>
                        <input type="text" id="username" class="form-control w-25" name="username" value="{% if username is defined %}{{ username|e }}{% endif %}">
                        {% if errors.emptyName is defined %}
                           <p>{{ errors.emptyName|e }}</p>
                        {% elseif errors.invalidName is defined %}
                           <p>{{ errors.invalidName|e }}</p>
                        {% endif %}
                     </div>
                     <div class="form-group mt-3">
                        <label for="email">E-mail :</label>
                        <input type="email" id="email" class="form-control w-25" name="email" value="{% if email is defined %}{{ email|e }}{% endif %}">
                        {% if errors.emptyMail is defined %}
                           <p>{{ errors.emptyMail|e }}</p>
                        {% elseif errors.invalidMail is defined %}
                           <p>{{ errors.invalidMail|e }}</p>
                        {% elseif errors.mailUsername is defined %}
                           <p>{{ errors.mailUsername|e }}</p>
                        {% endif %}
                     </div>
                     <div class="mt-2 text-end"><button class="button btn-primary shadow-none" type="submit" name="addComment">Poster un commentaire</button></div>
                     {% if reply is defined %}
                        {% if reply == 'ok' %}
                           <div><p class="msgValid">Votre commentaire a été envoyé.
                                 Il sera publié dans les prochaines heures après validation par la modération.</p></div>
                        {% endif %}
                     {% endif %}
                  </div>
               </form>
            </div>
         </div>
      </div>
   </div>
{% endblock %}